"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t,o,s,i){var n=function(e){if(e=tiny.extend({tr:{}},e),e.form=e.form||"#questions-form",e.questionText=e.questionText||"#question",e.submitButton=e.submitButton||"#question-btn",e.el=e.el||'[data-component="question"]',this.melidata=e.melidata,this.tr=e.tr,this.el=t.querySelector(e.el),!this.el)throw new Error("Question: component question does not exist");return this.ui={form:this.el.querySelector(e.form),questionText:this.el.querySelector(e.questionText),submitButton:this.el.querySelector(e.submitButton),myQuestionsBlock:this.el.querySelector("#questions-own"),myQuestionsTitle:this.el.querySelector("#questions-own > p"),personalQuestionsList:this.el.querySelector("#questions-own ul"),noQuestionsMessage:this.el.querySelector("#questions-empty"),itemId:this.el.querySelector("input[name=itemId]"),showMoreQuestionsButton:this.el.querySelector("#showMoreQuestionsButton"),shortDescText:t.querySelector(e.form+"-re "+e.questionText)},this.maxLength=this.ui.questionText?this.ui.questionText.getAttribute("maxlength")||2e3:2e3,this.snackbar=null,this.questionGroup=1,this.handlers={showQuestionGroup:this.showQuestionGroup.bind(this)},this.init(),this};n.prototype.init=function(){this.bindEvents()},n.prototype.bindEvents=function(){tiny.on(this.ui.form,"submit",this.send.bind(this)),tiny.on(this.ui.showMoreQuestionsButton,"click",this.handlers.showQuestionGroup),meli.on("question:edit",this.startEditMode.bind(this))},n.prototype.bindModalEvent=function(){meli.iframeModal&&i&&(tiny.off(this.ui.showMoreQuestionsButton,"click",this.handlers.showQuestionGroup),tiny.on(this.ui.showMoreQuestionsButton,"click",function(e){e.preventDefault(),e.stopPropagation(),this.blur(),meli.iframeModal.open(i(this))}))},n.prototype.send=function(e){if(e.preventDefault(),!this.ui.questionText.value.trim())return void this.ui.questionText.focus();var t=this,o=t.ui.form.getAttribute("action");t.ui.submitButton.disabled=!0,tiny.ajax(o,{data:t.serialize(t.ui.form),method:"POST",dataType:"json",context:t,success:t.sendSuccess,error:t.sendError})},n.prototype.serialize=function(e){var t,o,s=[];if("object"==("undefined"==typeof e?"undefined":_typeof(e))&&"FORM"==e.nodeName)for(var i=e.elements.length,n=0;i>n;n++)if(t=e.elements[n],t.name&&!t.disabled&&"file"!=t.type&&"reset"!=t.type&&"submit"!=t.type&&"button"!=t.type)if("select-multiple"==t.type){o=e.elements[n].options.length;for(var r=0;o>r;r++)t.options[r].selected&&(s[s.length]=encodeURIComponent(t.name)+"="+encodeURIComponent(t.options[r].value))}else("checkbox"!=t.type&&"radio"!=t.type||t.checked)&&(s[s.length]=encodeURIComponent(t.name)+"="+encodeURIComponent(t.value));return s.join("&").replace(/%20/g,"+")},n.prototype.sendSuccess=function(t){if(this.ui.submitButton.disabled=!1,"redirect"==t.status)e.location.href=t.url;else if("ok"==t.status){var o=this.melidata.source&&"modal"===this.melidata.source?"VIP-MODAL":"VIP";meli_ga("send","event","ITEM","CONTACT",o),Array.isArray(window.dataLayer)&&window.dataLayer.push({event:"vip-contact-seller"}),this.ui.itemId&&s("send","event",{path:"/vip/contact_seller",data:this.melidata}),meli.questionModal&&meli.questionModal.hide(),this.showFeedbackMessage({type:"ok"}),this.ui.questionText.value="",this.ui.shortDescText&&(this.ui.shortDescText.value="")}},n.prototype.sendError=function(e){var t=JSON.parse(e.responseText);meli.questionModal&&meli.questionModal.hide(),this.showFeedbackMessage({type:"error",message:t.error_message})},n.prototype.showFeedbackMessage=function(e){var t={ok:{type:"success",message:this.tr["¡Listo! Ya enviamos tu pregunta."]},error:{type:"error",message:e.message||this.tr["¡Ups! Hubo un problema al preguntar"]}}[e.type];this.snackbar=new Snackbar({type:t.type,message:t.message})},n.prototype.startEditMode=function(){this.ui.questionText.focus()},n.prototype.showQuestionGroup=function(e){e&&e.preventDefault(),this.questionGroup+=1;var t=this.el.querySelectorAll(".questions__group--"+this.questionGroup),o=this.el.querySelectorAll(".questions__group--"+(this.questionGroup+1));o.length||(this.ui.showMoreQuestionsButton.style.display="none",tiny.removeClass(this.el,"main-section--gradient")),Array.prototype.forEach.call(t,function(e){tiny.removeClass(e,"questions__group--hidden")}),this.ui.showMoreQuestionsButton.blur(),meli.emit("content:change"),4===this.questionGroup&&this.bindModalEvent()},o.Question=n}(window,document,Meli.prototype,window.parent.melidata,window.parent.jQuery);
//# sourceMappingURL=../js/questions-motors-alternative-8dc440f65b.js.map